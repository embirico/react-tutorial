<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Gabe</title>
    <!-- Not present in the tutorial. Just for basic styling. -->
    <link rel="stylesheet" href="css/base.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.14.7/react.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.14.7/react-dom.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.6.15/browser.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
  </head>
  <body>
    <div id="content"></div>
    <script type="text/babel">
      // To get started with this tutorial running your own code, simply remove
      // the script tag loading scripts/example.js and start writing code here.
      var Nav = React.createClass({
        render: function() {
          return (
            <div className="row"><span>Path Explorer</span></div>
          );
        }
      });

      var PlayerContainer = React.createClass({
        getInitialState: function() {
          return {player: null};
        },
        getAllData: function () {
          if (!this.state.player) {
            return []
          }
          return []; // TODO ajax
        },
        componentDidMount: function() {
          this.setState({player: 'Stephen Curry'});
        },
        handlePlayerChange: function(player) {
          this.setState({player: player});
        },
        render: function() {
          return (
            <div className="playerContainer">
              <PathContainer
                player={this.state.player}
                allData={this.getAllData}
                onPlayerChange={this.handlePlayerChange}
              />
            </div>
          )
        }
      });

      var PathContainer = React.createClass({
        selectedData: null,
        getInitialState: function() {
          return {offDef: 'offense', gridSel: [], playerSelectActive: false}
        },
        getNumPossessions: function() {
          return 12; // TODO
        },
        getFGPercent: function() {
          return 40; // TODO
        },
        getHistogramData: function() {
          return 'histogram'; // TODO
        },

        render: function() {
          return (
            <div className="pathContainer">
              <Header
                player={this.props.player}
                onPlayerChange={this.props.onPlayerChange}
                offDef={this.props.offDef}
              />
              {(this.state.playerSelectActive) ? <h1>PlayerSelect</h1> : <CourtContainer />}
              <StatsContainer
                numPossessions={this.getNumPossessions()}
                fGPercent={this.getFGPercent()}
                histogramData={this.getHistogramData()}
              />
            </div>
          );
        }
      });

      var Header = React.createClass({
        render: function() {
          return (
            <div className="header">
              <ChangePlayerButton onPlayerChange={this.props.onPlayerChange} />
              <PlayerName player={this.props.player} />
              <OffDefToggle offDef={this.props.offDef} />
            </div>
          )
        }
      });

      var ChangePlayerButton = React.createClass({
        handleClick: function(e) {
          e.preventDefault();
          this.props.onPlayerChange('Gabriel Poon');
        },
        render: function() {
          return (
            <a href="#" onClick={this.handleClick}>Change Player</a>
          )
        }
      });

      var PlayerName = React.createClass({
        render: function() {
          return (
            <h1>{this.props.player}</h1>
          )
        }
      });

      var OffDefToggle = React.createClass({
        render: function() {
          return (
            <form>
              <input
                type="radio"
                name="Offense"
                value="offense"
                checked={this.props.offDef == "offense"}
              >
                Offense
              </input>
              <input
                type="radio"
                name="Defense"
                value="defense"
                checked={this.props.offDef == "defense"}
              >
                defense
              </input>
            </form>
          )
        }
      });

      var CourtContainer = React.createClass({
        render: function() {
          return (
            <div></div>
          )
        }
      });

      var StatsContainer = React.createClass({
        render: function() {
          return (
            <div className="statsContainer">
              <PossessionsCount count={this.props.numPossessions} />
              <PossessionsFG percent={this.props.fGPercent} />
              <Histogram data={this.props.histogramData} />
            </div>
          )
        }
      });

      var PossessionsCount = React.createClass({
        render: function() {
          return (
            <div className="possessionsCount">
              <h2>{this.props.count}</h2>
              <p>Num possessions</p>
            </div>
          )
        }
      });

      var PossessionsFG = React.createClass({
        render: function() {
          return (
            <div className="possessionsFG">
              <h2>{this.props.percent}</h2>
              <p>Percent of field goals made</p>
            </div>
          )
        }
      });

      var Histogram = React.createClass({
        render: function() {
          return (
            <div className="histogram">
              <h2>Histogram</h2>
              <p>TODO</p>
            </div>
          )
        }
      });

      ReactDOM.render(
        <div>
          <Nav />
          <PlayerContainer />
        </div>,
        document.getElementById('content')
      );

    </script>
  </body>
</html>
